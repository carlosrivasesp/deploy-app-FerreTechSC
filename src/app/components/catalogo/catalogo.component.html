<app-navbar-principal></app-navbar-principal>

<!-- Espacio entre navbar y contenido -->
<div class="spacer d-block d-md-none" style="height: 1rem;"></div> <!-- móvil -->
<div class="spacer d-none d-md-block" style="height: 100px;"></div> <!-- escritorio -->

<div class="catalogo-wrapper container-perso mb-5 mt-4 mt-md-5">
  <div class="row gx-4">
    <!-- Sidebar filtros -->
    <aside class="col-12 col-md-4 col-lg-3 filtros-sidebar mb-4">
      <div class="filtros-wrapper p-3">
  <h4 class="fw-bold ">Filtros</h4>

  <section class="filter-section">
    <h5 class="section-title mb-2">Buscar</h5>
    <input type="text" class="form-control form-control-lg" placeholder="Buscar producto" [(ngModel)]="searchTerm" />
  </section>

  <section class="filter-section">
    <h5 class="section-title mb-2">Categoría</h5>
    <select class="form-select form-select-lg" [(ngModel)]="selectedCategory">
      <option value="">Todas las categorías</option>
      <option *ngFor="let cat of categorias" [value]="cat">{{ cat }}</option>
    </select>
  </section>

  <section class="filter-section">
    <h5 class="section-title mb-2">Ordenar</h5>
    <select class="form-select form-select-lg" [(ngModel)]="sortOrder">
      <option value="az">Nombre (A-Z)</option>
      <option value="za">Nombre (Z-A)</option>
    </select>
  </section>

  <section class="filter-section">
    <h5 class="section-title">Rango de Precios</h5>
    <div class="d-flex align-items-center">
      <span class="me-2">S/ {{ selectedMinPrice }}</span>
      <input
        type="range"
        class="form-range mx-2"
        [min]="0"
        [max]="maxPrice / 2"
        step="1"
        [(ngModel)]="selectedMinPrice"
      />
      <input
        type="range"
        class="form-range mx-2"
        [min]="maxPrice / 2"
        [max]="maxPrice"
        step="1"
        [(ngModel)]="selectedMaxPrice"
      />
      <span class="ms-2">S/ {{ selectedMaxPrice }}</span>
    </div>
  </section>
  <section class="filter-section ">
  <h5 class="section-title mb-2">Marcas</h5>
<div class="marcas-checkboxes">
  <label *ngFor="let marca of marcas">
    <input type="checkbox" [(ngModel)]="selectedMarcas[marca]" /> {{ marca }}
  </label>
</div>

</section>

</div>

    </aside>

    <!-- Catálogo -->
    <section class="col-12 col-md-8 col-lg-9">
      <!-- Título y subtítulo -->
      <div class="row mb-4">
        <div class="col-12 text-center">
          <h2 class="fw-bold">Catálogo de Productos</h2>
          <p class="text-muted fst-italic small mt-2">
            Encuentra lo mejor para ti con nuestros productos seleccionados
          </p>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-3">
  <p class="text-muted mb-0">{{ productosFiltrados.length }} productos encontrados</p>

  <nav aria-label="Paginación catálogo">
    <ul class="pagination pagination-sm mb-0">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <button class="page-link" (click)="setPage(currentPage - 1)" [disabled]="currentPage === 1">Anterior</button>
      </li>

      <li 
        class="page-item" 
        *ngFor="let page of [].constructor(totalPages); let i = index"
        [class.active]="currentPage === i + 1"
      >
        <button class="page-link" (click)="setPage(i + 1)">{{ i + 1 }}</button>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <button class="page-link" (click)="setPage(currentPage + 1)" [disabled]="currentPage === totalPages">Siguiente</button>
      </li>
    </ul>
  </nav>
</div>


      <div class="row justify-content-center gx-3 gy-4">
        <div
          class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-1-5"
          *ngFor="let producto of productosFiltrados"
        >
          <div class="card h-100 shadow-sm rounded">
            <div class="img-container">
              <img
                *ngIf="producto.imageUrl; else noImage"
                [src]="producto.imageUrl"
                alt="Imagen del producto"
                class="card-img-top"
              />
              <ng-template #noImage>
                <div class="no-image"></div>
              </ng-template>
            </div>

            <div class="card-body d-flex flex-column justify-content-between">
              <div>
                <h5 class="card-title">{{ producto.nombre }}</h5>
                <p class="fw-light text mb-0"> Stock: {{ producto.stockActual }}</p>
              </div>

              <div class="d-flex justify-content-between align-items-center mt-3">
                <p class="fw-bold text-success mb-0">S/ {{ producto.precio }}</p>
<button class="btn-shadcn btn-m d-flex align-items-center" (click)="agregarAlCarrito(producto)">
  <i class="bi bi-cart-plus me-1"></i> Comprar
</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<footer class="footer text-light py-5 mt-5">
  <div class="container text-center">
    <div class="footer-top mb-3">
      <h5 class="mb-2">Mi Tienda</h5>
      <p class="mb-1">infomitienda.com</p>
      <p>Teléfono: +51 123 456 789</p>
    </div>

    <hr class="footer-divider" />

    <div class="footer-bottom mt-3">
      <p class="small mb-0">&copy; 2025 Mi Tienda - Todos los derechos reservados.</p>
    </div>
  </div>
</footer>
