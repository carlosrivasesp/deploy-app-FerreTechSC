<app-navbar-principal></app-navbar-principal>
<div class="spacer d-none d-md-block" style="height: 150px;"></div> <!-- escritorio -->
<main class="main-content">
  <div class="side-decor left"></div>
  <div class="side-decor right"></div>

  <div class="resumen-compra-container container py-3">

    <h2 class="resumen-titulo mb-4">
      <i class="fas fa-file-invoice me-2"></i> Resumen de Compra
    </h2>

    <div *ngIf="cartItems.length > 0; else carritoVacio">

      <!-- Lista de productos -->
      <div class="carrito-item card shadow-sm p-3 mb-3" *ngFor="let item of cartItems">
        <div class="row align-items-center">

          <!-- Imagen con skeleton -->
          <div class="col-3 col-md-2 text-center">
            <div class="skeleton-image rounded"></div>
          </div>

          <!-- Info -->
          <div class="col-6 col-md-6">
            <h5 class="mb-1">{{ item.nombre }}</h5>
            <p class="mb-1 text-muted">
              <i class="fas fa-tag me-1"></i> Precio: <strong>S/ {{ item.precio }}</strong>
            </p>
            <p class="mb-0 text-muted">
              <i class="fas fa-calculator me-1"></i> Total: <strong>S/ {{ item.precio * item.cantidad | number: '1.2-2'
                }}</strong>
            </p>
          </div>

          <!-- Cantidad y eliminación -->
          <div class="col-12 col-md-4 text-center text-md-end botones-control">
            <div class="cantidad-stepper d-inline-flex align-items-center">
              <span class="cantidad-display">{{ item.cantidad }}</span>
            </div>
          </div>

        </div>
      </div>

      <!-- Resumen de la compra -->
      <div class="carrito-resumen card shadow-lg p-4 mt-4">
        <h4 class="mb-3">
          <i class="fas fa-file-invoice-dollar me-2"></i> Detalles de la Compra
        </h4>
        <p><i class="fas fa-money-bill-wave me-1"></i> Subtotal: <strong>S/ {{ subtotal | number: '1.2-2' }}</strong>
        </p>
        <p><i class="fas fa-percentage me-1"></i> IGV (18%): <strong>S/ {{ igv | number: '1.2-2' }}</strong></p>
        <p class="total-final fs-5"><i class="fas fa-receipt me-1"></i> Total: <strong>S/ {{ totalPrice | number:
            '1.2-2' }}</strong></p>

        <!-- Formulario de confirmación -->
        <div class="form-group">
          <label for="tipoComprobante">Tipo de Comprobante</label>
          <select id="tipoComprobante" class="form-control" [(ngModel)]="tipoComprobante">
            <option value="Factura">Factura</option>
            <option value="Boleta">Boleta</option>
          </select>
        </div>

        <div class="form-group mt-3">
          <label for="metodoPago">Método de Pago</label>
          <select id="metodoPago" class="form-control" [(ngModel)]="metodoPago">
            <option value="Efectivo">Efectivo</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Yape">Yape</option>
          </select>
        </div>

        <div class="form-group mt-3">
          <label for="cliente">Cliente</label>
          <input type="text" class="form-control" id="cliente" [(ngModel)]="cliente" placeholder="Nombre del Cliente">
        </div>

        <button class="btn btn-primary w-100 mt-3" (click)="confirmarCompra()">
          <i class="fas fa-check me-2"></i> Confirmar Compra
        </button>
      </div>

    </div>

    <!-- Si el carrito está vacío -->
    <ng-template #carritoVacio>
      <div class="carrito-vacio card shadow-sm p-5 text-center">
        <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>
        <p class="fs-5 mb-2">Tu carrito está vacío.</p>
        <a routerLink="/catalogo" class="btn btn-outline-primary">
          <i class="fas fa-store me-2"></i> Ir al catálogo
        </a>
      </div>
    </ng-template>

  </div>
</main>